# From example_rules/example_frequency.yaml
es_host: elasticsearch
es_port: 9200
name: Security Onion ElastAlert - Malware Event
type: frequency
index: "*:logstash-ids*"
num_events: 1
timeframe:
    minutes: 15
buffer_time:
    minutes: 15
filter:
- query:
    query_string:
      query: "alert: \"ETPRO MALWARE\""

# Only count number of records, instead of bringing all data back
#use_count_query: true
#doc_type: 'doc'

alert:
  - "command"

command: ["/etc/elastalert/rules/ip2mac.py", "--ip", "%(source_ip)s"]
#command: ["cd /data2/python_venv/3.5/packetfence/", ". bin/activate", "bin/python packetfence/ip2mac.py", "--ip", "%(source_ip)s"]

#command:
  #- "cd /data2/python_venv/3.5/packetfence/"
  #- ". bin/activate"
  ##- "source bin/activate &&"
  #- "bin/python packetfence/ip2mac.py"
  #- "--ip"
  #- "%(source_ip)s"
