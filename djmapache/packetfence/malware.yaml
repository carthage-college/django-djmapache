# From example_rules/example_frequency.yaml
es_host: elasticsearch
es_port: 9200
name: Security Onion ElastAlert - Malware Event
type: frequency
index: "*:logstash-ids*"
num_events: 1
timeframe:
    minutes: 15
buffer_time:
    minutes: 15
filter:
- query:
    query_string:
      query: "alert: /.*MALWARE.*/ OR alert: /.*malware.*/ OR alert: /.*Malware.*/"
      analyze_wildcard: true

alert:
  - "command"

command: ["/etc/elastalert/rules/malware.py", "--alert", "%(alert)s", "--ip", "%(source_ip)s", "--sid", "2000000", "--action", "apply_security_event"]

#command: ["/etc/elastalert/rules/malware.py", "--alert", "%(alert)s", "--ip", "%(source_ip)s", "--sid", "2000000", "--action", "apply_security_event", "--test"]
#command: ["cd /data2/python_venv/3.5/packetfence/", ". bin/activate", "bin/python packetfence/ip2mac.py", "--ip", "%(source_ip)s"]
#command:
  #- "cd /data2/python_venv/3.5/packetfence/"
  #- ". bin/activate"
  ##- "source bin/activate &&"
  #- "bin/python packetfence/ip2mac.py"
  #- "--ip"
  #- "%(source_ip)s"
